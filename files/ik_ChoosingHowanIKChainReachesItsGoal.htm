<!DOCTYPE html>

<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="SI">
      <meta name="release" content="2015">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2014-03-26">
      <meta name="topicid" content="GUID-C818747E-474D-44BB-BABD-642595408C4C">
      <meta name="indexterm" content="chains: solving IK behavior">
      <meta name="indexterm" content="solvers for inverse kinematics">
      <meta name="indexterm" content="effectors: solvers on">
      <meta name="indexterm" content="inverse kinematics: solvers">
      <meta name="indexterm" content="joints: methods for solving rotations">
      <meta name="indexterm" content="inverse kinematics: solver angles for joint rotations">
      <meta name="indexterm" content="inverse kinematics: SOFTIMAGE|3D behavior for solving joint rotations">
      <meta name="indexterm" content="SOFTIMAGE|3D: solving joint rotations behavior">
      <meta name="indexterm" content="inverse kinematics: solving joint rotations from preferred angles">
      <meta name="indexterm" content="effectors: forcing position">
      <meta name="indexterm" content="inverse kinematics: forcing IK behavior">
      <meta name="indexterm" content="chains: forcing IK behavior">
      <meta name="indexterm" content="forcing IK behavior">
      <meta name="indexterm" content="solvers for inverse kinematics: error threshold">
      <meta name="indexterm" content="error threshold for IK solver">
      <meta name="topic-type" content="concept">
      <title>Choosing How an IK Chain Reaches Its Goal</title>
      <link rel="stylesheet" type="text/css" href="../style/softimage.css"><script type="text/javascript" src="../scripts/ac_common.js"></script><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script></head>
   <body height="100%">
      <div class="body_content" id="body-content"><span class="anchor_wrapper"><a name="GUID-C818747E-474D-44BB-BABD-642595408C4C"></a></span><div class="head">
            <h1> Choosing How an IK Chain Reaches Its Goal</h1>
         </div>
         <div class="bodyProcess">
            <p><span class="anchor_wrapper"><a name="GUID-F400D7F2-6174-4462-BDC9-6500DE065694"></a></span>When you translate a chain's effector to invoke inverse kinematics, Softimage uses
               a <em class="mild">solver</em> — an algorithm that "solves" how the effector will reach its goal by calculating
               how the joint angles should change. You can select both the type of solver Softimage
               uses, as well as the solver angle methods for calculating the joint rotations.
            </p>
            <div class="figure-anchor"><img src="../images/GUID-7933A493-E76C-42ED-A288-6924A37F0BCE-low.png"></div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0040"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-4535C61D-D0F9-46F6-B8F0-FC03715DF310"></a></span>To change a chain's behavior
               </h2> <span class="anchor_wrapper"><a name="GUID-EBFEF9BD-60F7-4A92-BA51-51A5E3791440"></a></span><ol type="1" start="1">
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-F35CE98D-5B19-4020-90E8-521ACFE93B1C"></a></span>Select any chain bone and press Ctrl+R to open the Kinematic Chain property editor.
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-84077F3D-D441-4966-8FBE-5247BD86CA00"></a></span>Use the <span class="MenuCascade" id="GUID-EEFD974F-00E2-4E82-9178-9049D52C03FC">Solver</span> list to change the chain's behavior. You can use one of two solvers for a chain:
                        the SI|3D or XSI Solver (see next section for information on choosing between the
                        two).
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-49A6FD7A-2842-4323-B533-7E2855DF444E"></a></span>Choose one of three <span class="MenuCascade" id="GUID-B9E02C0F-0CB6-4F02-9686-B51762FD5208">Solver Angle</span> methods for calculating joint rotations when using IK (see <span class="char_link"><a href="ik_ChoosingHowanIKChainReachesItsGoal.htm#WSF4D645293765AE498C69174E3D6620E4-0042">Calculating Joint Rotations with the Solver Angle</a></span> for information on choosing among the three methods).
                     </p> 
                  </li>
               </ol> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0041"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-8E8E0666-F0EB-4700-B065-ECCA03E705D2"></a></span>Choosing a Solver
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-28B9FADB-5EF3-458E-A86D-6BBFB4A722F4"></a></span>You can choose to use either the SI|3D or XSI Solver. Whichever solver you choose,
                  it's easy to switch between them. If you find that different solvers work best for
                  different situations on the same chain, you can even set keys on the Solver options
                  (click its animation icon) to animate the switching from one solver to the other at
                  specific frames.
               </p> 
               <ul>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-87030DEB-A05E-4DB8-AA8B-697132797E49"></a></span>The <span class="MenuCascade" id="GUID-F24907CE-345D-477A-90E6-99AF1221D081">SI|3D Solver</span> uses the same algorithm as in SOFTIMAGE|3D to provide compatibility with that program.
                        If you have scenes from SOFTIMAGE|3D that you want to import into Softimage, you should
                        use this solver to be sure that the angles are calculated the same way for your chains
                        in both programs.
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-11890374-5468-4149-B4C0-F9CA06731A5C"></a></span>The <span class="MenuCascade" id="GUID-06A1B19E-259B-468E-9278-B5ACABFDA7AF">XSI Solver</span> uses an algorithm that usually provides quick results when translating the effector.
                        Because the XSI solver is based on the Softimage architecture, it works better with
                        elements that are different from (rotation limits and up-vector constraints) or didn't
                        exist in SOFTIMAGE|3D (such as joint stiffness, pseudo-roots, and bone rolls). It
                        knows how to stabilize and solve the chain more effectively than the SI|3D solver.
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-17EC6C61-FDBB-4047-9A21-20832ECA82A8"></a></span>If you're working exclusively in Softimage, you may find this solver more efficient.
                     </p> 
                  </li>
               </ul> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0042"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-E89EBA83-F248-4EB5-9C4B-E95E51933F55"></a></span>Calculating Joint Rotations with the Solver Angle
               </h2>   
               <p><span class="anchor_wrapper"><a name="GUID-E6E84423-A452-490C-A8EE-CC891108D2FA"></a></span>When you draw a chain, the angles at each joint are seen as the "home state", known
                  as the preferred angles, of the chain. When you use IK, these <em class="mild">preferred angles</em> are used as an initial solution for the IK solver. Reading those angles, the solver
                  computes a solution that depends on these angles and the goal position (as well as
                  any up-vector or preferred axis constraints). For more information, see <span class="char_link"><a href="ik_AnimatingwithInverseKinematics.htm#WSF4D645293765AE498C69174E3D6620E4-001F">Preferred Angles</a></span>.
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-3E5E50AC-8988-42EC-8A8D-E796601BE1B3"></a></span>Choose one of three <span class="MenuCascade" id="GUID-BF1E900D-2927-482B-8FB1-FE0371726889">Solver Angle</span> methods for calculating joint rotations when using IK:
               </p> 
               <ul>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-384485E6-4860-4262-ADFC-CAA3F01048A2"></a></span> <span class="MenuCascade" id="GUID-4F267E5E-8FF7-4E45-9D13-6AE1B629955E">Use Joint Rotations (SI|3D Behavior)</span> updates the preferred angles when the joint angles are changed by any means other
                        than IK (such as by bone rotation - FK), which will affect further IK joint calculations.
                        This is the same behavior as in SOFTIMAGE|3D, and chains imported from SOFTIMAGE|3D
                        automatically assume this behavior. IK and FK have the same priority with this method,
                        which means that the IK may be slightly less predictable.
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-358D1491-B552-4D99-AFD0-090716206F31"></a></span>If a subchain is to be solved in IK, expressions on this subchain are ignored. Otherwise,
                        expressions take precedence over changes you make by directly manipulating the chain
                        (transforming it), and direct manipulation changes takes precedence over fcurves (or
                        other local orientation control).
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-7C78B681-8590-4023-A39C-437BFE414E1C"></a></span> <span class="MenuCascade" id="GUID-F8122130-0785-42B7-81CC-A2EF93EABFAF">Use Preferred Rotations from Joint Properties</span> calculates rotation values based on the joints' preferred angles. The preferred angles
                        in the bones stay at what you set them, meaning that the joint rotations are always
                        predictable; a given effector position always results in the same rotation values.
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-0FF175C0-4660-4390-9AFB-6E02A0C5840B"></a></span>IK has priority over FK with this method: FK only modifies the preferred angles of
                        the bones, and the IK will always bend the correct way once you've set it.
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-01D7D034-3B43-4E2C-8269-BA295B1B5CB8"></a></span>The only way to stay in this joint rotation mode and change the preferred angle is
                        to do so from the Kinematic Joint property editor (see <span class="char_link"><a href="ik_ChangingtheJointxd5sPreferredAngle.htm"> Changing the Joint's Preferred Angle</a></span> — you can see the result of doing so if Force IK is on).
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-C988B9BD-3A00-4918-B7E7-C8837337C971"></a></span> <span class="MenuCascade" id="GUID-1818ABDC-138C-4E2F-A0B9-04B23F442722">Reuse Joint Rotation at Every Resolution Step</span> ignores the preferred angles and calculates rotation values based on the joints'
                        current angles (it keeps bending the direction that it was last bending). If you manipulate
                        the chain in FK, and then IK, the chain won't snap back to its preferred angle. When
                        the chain is extended to its full length, translating the effector toward the root
                        causes the chain to bend in one direction.
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-D56A21B2-C635-46C0-801F-8FDD2B25F978"></a></span>Because unpredictable behavior can occur when you use IK, this method is really only
                        practical for FK and is the option for doing "pose-to-pose" animation. Of course,
                        you can use IK to place the chain approximately where you want, then rotate the bones
                        (FK) and key their rotations.
                     </p> 
                  </li>
               </ul> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0043"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-CE394B33-4EA7-4B34-95C0-DD9D0654B7A6"></a></span>Forcing the Effector's Position
               </h2>  
               <p><span class="anchor_wrapper"><a name="GUID-A35FD99E-E11F-4692-9347-FEF6928F92DE"></a></span>Select the <span class="MenuCascade" id="GUID-813FABF1-125F-457D-ADA3-911F4E5B654B">Force IK</span> option on the Kinematic Chain property page to trigger IK every time you modify the
                  preferred angles from the Kinematic Joint property page (see <span class="char_link"><a href="ik_ChangingtheJointxd5sPreferredAngle.htm"> Changing the Joint's Preferred Angle</a></span>). This way, you can immediately see the effect of IK on the chain.
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-1F38E890-CE94-45AC-8BF3-51BECA33497B"></a></span>Using <span class="MenuCascade" id="GUID-6E519E85-D6C1-430F-9E03-C522FC07C947">Force IK</span> lets you test out the effect that manipulating bones has on the IK solution without
                  actually adding animation to or manipulating the effector.
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-5E31356B-2F35-415C-9434-290FE167DD47"></a></span>If you select <span class="MenuCascade" id="GUID-0AEFBA6F-CBFE-4543-AE74-1BE64B0E76A6">Force IK</span>, you can temporarily force the effector to stay in place if it is not already animated.
                  Thus, with any <span class="MenuCascade" id="GUID-5A16154B-0107-4234-942E-58F7C77AD893">Solver</span> Angles method, you can edit the preferred angles in the Kinematic Joint property
                  editor or rotate the bones interactively.
               </p> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0044"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-FF22C3A2-FADD-4668-BDC4-24EFB1CD88EC"></a></span>Setting the Solver's Error Threshold
               </h2>   
               <p><span class="anchor_wrapper"><a name="GUID-748A0E81-8E21-4F63-8F19-6C8216AE7368"></a></span>When you're animating long chains (especially 3D chains), the error tolerance on the
                  solver can sometimes get too large and the chain's effector may "pop" to another location.
                  This may also be a problem when you have stiffness or rotation limits set on 3D chains.
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-65F380D3-CE94-4544-8B0F-24D9753DCF93"></a></span>To solve these problems, you can lower the solver's error threshold, meaning that
                  less distortion is allowed to occur as it solves the chain's angles.
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-4AE6E720-83BD-40D4-822F-2DBDC4C58239"></a></span>The error threshold affects only:
               </p> 
               <ul>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-0F2FE0A8-AA87-4946-9AB6-AB432974A41B"></a></span>3D chains with more than one bone using either the SI|3D or XSI solver.
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-CC969676-608F-49CB-BE7B-C03F20B103D9"></a></span>2D chains with more than two bones using the SI|3D solver.
                     </p> 
                  </li>
               </ul> 
               <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0045"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-041F3DB7-A7CA-4976-A998-B93689EC81F1"></a></span>To change the solver's error tolerance
                  </h3> <span class="anchor_wrapper"><a name="GUID-9191AB05-E266-4CB2-9AD6-F1C24CB4DF25"></a></span><ol type="1" start="1">
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-C046F627-0174-48FF-8040-877AFEA3DF71"></a></span>Open the chain's Kinematic Chain property page.
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-ECFEB454-8211-4AB9-AB05-472E5765BA28"></a></span>Select <span class="MenuCascade" id="GUID-62A6A2F7-19F4-4EC9-B86A-40C09C59364B">User Defined</span> as the Error Threshold <span class="MenuCascade" id="GUID-B2D80D3B-2B2C-4C6D-A2B1-69C8D041082E">Type</span>.
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-F4DCAC5D-27C7-4CDA-8A6E-C6DAA20A7B01"></a></span>Lower the <span class="MenuCascade" id="GUID-3E941513-BD79-47EE-B66D-356D7B308289">Threshold</span> value until the problem stops occurring. This value is in Softimage units, with 1
                           being one grid square.
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-7792D2B3-E243-4C71-BD2C-9B1558D6AD18"></a></span>You need to set the Threshold value relative to the chain's length. This means that
                           generally, the shorter the chain, the lower you need to set the value to solve any
                           problem.
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-122CF17D-8526-4D6F-84CD-6AF6D7C55BFC"></a></span>The amount that the camera is zoomed in or out of the view is also a consideration.
                           For example, if the camera is zoomed in closely to the chain, you may need to use
                           a very low value.
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-492B108C-1C39-46E9-B42E-A93B367882CB"></a></span>The speed at which the solver calculates the chain is affected by a combination of
                           the chain's length and the Threshold value. As the Threshold value gets lower relative
                           to the chain's length, the longer it takes to solve. For example, a long chain with
                           a high value could take the same amount of time to calculate as a short chain with
                           a low value.
                        </p> 
                        <div><span class="anchor_wrapper"><a name="GUID-2E276ADF-71B0-4B32-A2ED-D77FDD554D1C"></a></span><div class="note-note"><span class="label">NOTE:</span>If the value is too low, the solver may not reach a solution and the effector won't
                              reach the IK goal.
                           </div>
                        </div> 
                     </li>
                  </ol> 
               </div> 
            </div>
         </div>
         <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>Except where otherwise noted, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. Please see the <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons FAQ</a> for more information.</em></p><br></div>
   </body>
</html>