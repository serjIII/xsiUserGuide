<!DOCTYPE html>

<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="SI">
      <meta name="release" content="2015">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2014-03-26">
      <meta name="topicid" content="GUID-14884AF9-388D-4C63-B5CF-325B05F4FACE">
      <meta name="indexterm" content="CrowdFX: preparing a model for importing">
      <meta name="indexterm" content="CrowdFX: envelope on source model">
      <meta name="indexterm" content="CrowdFX: rig on source model">
      <meta name="indexterm" content="CrowdFX: action sources for source model">
      <meta name="indexterm" content="CrowdFX: importing models from other software">
      <meta name="topic-type" content="concept">
      <title>Preparing a Model for CrowdFX</title>
      <link rel="stylesheet" type="text/css" href="../style/softimage.css"><script type="text/javascript" src="../scripts/ac_common.js"></script><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script></head>
   <body height="100%">
      <div class="body_content" id="body-content"><span class="anchor_wrapper"><a name="GUID-14884AF9-388D-4C63-B5CF-325B05F4FACE"></a></span><div class="head">
            <h1>Preparing a Model for CrowdFX</h1>
         </div>
         <p><span class="anchor_wrapper"><a name="GUID-2670BED3-6AE5-443A-A5B0-4DB5780C91EF"></a></span>  
         </p>
         <p><span class="anchor_wrapper"><a name="GUID-C5479157-8E77-41DB-8125-F0A06C287AF7"></a></span>CrowdFX is designed to be used with any type of rigged polygon mesh envelope in a
            model that has action sources. This model is known as an actor when used in CrowdFX.
            With typical crowd scenes, these actors are usually bipeds or quadrupeds, but you
            aren't limited to that. 
         </p>
         <p><span class="anchor_wrapper"><a name="GUID-4B289705-C0FD-4E05-AD14-3F8D785B6CA3"></a></span>Of course, there are some requirements for the model and its animation that need to
            be met before you can use it as an actor in CrowdFX. 
         </p>
         <p><span class="anchor_wrapper"><a name="GUID-33F4F518-B229-436B-8EE2-B769297C8D12"></a></span> <img src="../images/GUID-8D010898-EB89-4A9B-AFCE-A56F06A3A585-low.png"> 
         </p>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_B5E5ADED4591436E8ED57C196C586B45"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-F9D2A246-2442-43A2-B1D5-571D76801AC9"></a></span>Model
            </h2> <span class="anchor_wrapper"><a name="UL_07E84911765F4FDC92011A8E7AF2B238"></a></span><ul>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-AFD3D2B6-313C-43BA-88E2-16516C868F11"></a></span> The character or rigged polygon mesh object must be in a model hierarchy - see <span class="char_link"><a href="models_WhatAreModels.htm">What Are Models?</a></span> for information. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-9E59EBD3-0769-4EC7-9540-A62355D1C823"></a></span> <img src="../images/GUID-BB03C5D8-3548-4BA7-A29E-A2EDF3950DE2-low.png"> 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-21DA7301-CD23-46C8-89DE-5DD233A98A7A"></a></span>Make sure that the model is located at the scene's global origin. 
                  </p> 
               </li>
            </ul> 
         </div>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_73FBCA3942824EF79BCF08D0BB6A70D2"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-D58BF5E9-CA0C-4065-821E-62DDF491E5FD"></a></span>Envelopes
            </h2>  
            <p><span class="anchor_wrapper"><a name="GUID-A16BDC00-45A3-466E-BAFE-D0C4E96BB848"></a></span> <span class="anchor_wrapper"><a name="UL_A3B784383ECA44CCA9C0BFF14F1063A5"></a></span><ul>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-ECEA6713-4536-4924-9ECB-F4AB45B660C0"></a></span> A single polygon mesh must be set as the envelope geometry (only one Envelope operator
                        applied on the mesh). If several enveloped meshes are found in the model, you are
                        prompted to choose the correct one in an explorer that pops up when you load the model
                        for CrowdFX (see <span class="char_link"><a href="GUID-AF081E95-A70E-4BA6-A1DC-856C05C35A46.htm">Loading Actors for the Crowd Simulation</a></span>). 
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-3062632B-F2E3-4502-8D08-08564D5133FD"></a></span>You can merge all polygon mesh objects of a character into one mesh for the envelope
                        using the <span class="MenuCascade" id="GUID-BCA04E9A-ECB0-4ADB-B243-5AE53B0CA158">Create <img src="../images/ac.menuaro.gif"> Poly Mesh <img src="../images/ac.menuaro.gif"> Merge</span> command on the Model toolbar - see <span class="char_link"><a href="polys_BlendingandMergingPolygonMeshes.htm">Blending and Merging Polygon Meshes</a></span>. Use Modeling Input for the construction mode and don't forget to transfer the envelope
                        weights. 
                     </p> 
                  </li>
                  <li>The envelope cluster must be named EnvelopeWeightCls, which is the default name. If
                     your envelope cluster is different and you want to keep that name, you can edit the
                     reference node in the Mesh Proxy object's ICE tree: open the Set Mesh Proxy compound
                     for editing, then change the envelope cluster name in the Get Envelope Cluster node.
                     
                  </li>
                  <li>The polygon mesh resolution can be as high as you like, but be aware that this mesh
                     will be used for every instance (per particle) of the actor when it's simulated, and
                     the playback performance will be affected. Try using the <em class="strong">Polygon Reduction</em> tool to help reduce a dense mesh - see <span class="char_link"><a href="polys_PolygonReduction.htm">Polygon Reduction</a></span>. In many cases, especially if the camera is far from the crowd, a lower-resolution
                     mesh will look fine and give faster playback. <span class="anchor_wrapper"><a name="FIG_81C151FEDE1F46409E58218590D1B44A"></a></span><div class="figure-anchor"><img src="../images/GUID-B432ECE9-39E9-4D37-A691-E55DF5CCF710-low.png"></div> 
                  </li>
               </ul> 
            </p> 
         </div>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_A536E5AF68B94B349EB712910CAC2C0B"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-E3901E6B-AE0B-4E4F-9F6C-433AE7BFBEDB"></a></span>Rigs
            </h2> 
            <p><span class="anchor_wrapper"><a name="GUID-F5AFEAB6-2DCB-4CBF-93A0-0EAAFBC77B01"></a></span>  
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-8F7CF9EF-2682-4403-A31B-ABB1C4D30411"></a></span> The character or polygon mesh object needs a rig that deforms the envelope. Consider
               the following issues for it: 
            </p> <span class="anchor_wrapper"><a name="UL_3F3CF78EFDD14002BBEF1D10DEB40D1C"></a></span><ul>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-B9EEACF4-C210-4ADC-BD23-1943E936D19B"></a></span>The envelope deformers can be either bones or nulls. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-A8F837F0-0B8E-4C80-85A1-DF83BBE53C0F"></a></span>A main COG-type (center of gravity) element needs to be a deformer, and can have any
                     name. The CrowdFX system automatically identifies this deformer when you select the
                     actor for CrowdFX, and uses its velocity for locomotion calculations (see <span class="char_link"><a href="GUID-88FB9DAE-3E03-4335-90D9-476D4C83E014.htm#GUID-DA4383B0-AA6A-4A1B-892B-790DC0B8BCFA">The Actor's Center of Gravity (COG) Deformer</a></span>). 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-9DA8726A-231C-486E-BBE3-6AE80ED4A73C"></a></span>There's no real limit to the number of envelope deformers you can have in a rig, but
                     be aware that each deformer will be used for every instance (per particle) of the
                     actor when it's simulated. If you remove unnecessary deformers (such as extra deformers
                     for the fingers, feet, or face), there will be better playback performance for the
                     same look. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-2032C2C6-E08F-40EC-8594-58FBD3C1646A"></a></span>If the rig is the same for all actors you've loaded for the crowd simulation, you
                     can simplify many operations, such as sharing action sources and modifying the rig
                     proxy to affect all actors who use that rig proxy. For example, you could duplicate
                     the same model and then make changes to the envelope or materials while keeping the
                     same rig. 
                  </p> <span class="anchor_wrapper"><a name="FIG_EBCAD981DBBF4C0EB4947A9F63DFE6B2"></a></span><div class="figure-anchor"><img src="../images/GUID-04010B13-5FEC-45A1-88FB-058780302B84-low.png"></div> 
               </li>
            </ul> 
         </div>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_C98D3D4AF48D48ADB5288C91F38BB90D"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-610C635D-E4B6-43E1-BAC2-A7A5A6754694"></a></span>Action Sources
            </h2>  
            <p><span class="anchor_wrapper"><a name="GUID-ADD6BD2C-78D9-4AA9-A9AA-EFCEBFDD81F0"></a></span> <span class="anchor_wrapper"><a name="UL_DFAD54DB90FE4871A8E464EFFA480822"></a></span><ul>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-5749D01E-14A1-4161-9298-E40C364C2BA1"></a></span>Each model must have its animation stored in action sources defined in its Mixer &gt;
                        Sources &gt; Animation node. 
                     </p> <span class="anchor_wrapper"><a name="FIG_CC5AE5AE56E74977A8D254D3CACC6CA6"></a></span><div class="figure-anchor"><img src="../images/GUID-B86BACC8-532E-4584-A7CB-83C6099DA112-low.png"></div> 
                  </li>
               </ul> 
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-4E168115-363F-4190-A907-54D1395AD24D"></a></span>Locomotion-type animation stored in the action source must be moving in global space.
               
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-85827330-575E-4A23-AD51-10A8CF9D204A"></a></span>If the action is in global space, it needs to be moving in the positive Z direction,
               such as a walk cycle going forward. This allows CrowdFX to immediately compute the
               ideal speed for any locomotion in the crowd simulation. The velocity used for each
               action source in the simulation is calculated based on the horizontal speed of the
               character's COG deformer. 
            </p> 
         </div>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_8D90C669EB5C470F9ADBB52ED832112F"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-786052A1-F256-42E5-8C9F-8C4460433929"></a></span>Materials and Textures
            </h2> 
            <p><span class="anchor_wrapper"><a name="GUID-2F5EA0BD-9158-4E8F-9300-561CA4404DC1"></a></span> Make sure that the correct material is applied to the character's envelope object,
               or to multiple clusters on the envelope mesh. The materials on the clusters are converted
               to ICE Materials on the actor when it's imported into CrowdFX. See <span class="char_link"><a href="GUID-B3F59924-07E5-4155-AEB8-F5D1A0A358D9.htm">Modifying the Actor's Materials and Textures</a></span> for information. 
            </p> <span class="anchor_wrapper"><a name="FIG_E1C622B726124C3185FF7A8E902AD2E0"></a></span><div class="figure-anchor"><img src="../images/GUID-D0C281C8-C284-4D27-BD7D-AFF4E54EE0D0-low.png"></div> 
         </div>
         <div class="section"><span class="anchor_wrapper"><a name="SECTION_352610E1D71449B897DCBDAFC72F5AA2"></a></span> 
            <h2><span class="anchor_wrapper"><a name="GUID-2FC82563-3F23-4F9F-9E99-A525B68D4F50"></a></span>Importing Models for CrowdFX
            </h2>  
            <p><span class="anchor_wrapper"><a name="GUID-50B9B59E-9E8E-49E9-AF1D-F03F58A50A13"></a></span>In addition to the CrowdFX requirements listed above, here are some tips for importing
               a model from another 3D software, such as Autodesk Maya. 
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-66A749DB-8E07-4587-A2E4-73A3DEDEA9BC"></a></span>The FBX file format is the most typical and stable format for importing models into
               Softimage. You can import a first FBX file to get the character (mesh and rig), and
               then import other FBX files with the same rig but different animations. 
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-7A1E5359-A0E7-4ED9-8DB9-FF3163E04E29"></a></span>For each imported animation, select the <span class="MenuCascade" id="GUID-E0C44B20-A446-47C3-959C-0D1F569DA740">Import as Action Source</span> option on the Import tab in the <span class="char_link"><a href="dataman_xwalk_props_ImportFBXOptionsDialogBox.htm"> Import FBX Options Dialog Box</a></span> to add only the animation as an action source. Then on the Animation tab, select
               the <span class="MenuCascade" id="GUID-99F5E932-BF04-472C-8AA9-32F3085B1EA5">Take</span> you want to import (you can import only one take at a time). Make sure to deselect
               the <span class="MenuCascade" id="GUID-EA413501-BA95-4801-BD0C-1EFF329F80A4">Skeleton</span> and <span class="MenuCascade" id="GUID-6B8D2DA8-C9C2-4E72-8455-D3799B92C106">Envelope</span> options on this tab so you don't import the rig again when you just want the animation.
               
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-5344EDC5-B87C-4A40-8017-0C8D5AFEF2CF"></a></span>If the model uses several meshes, use the <span class="MenuCascade" id="GUID-5A321F8C-C328-401A-98C4-3C9DE28B2F26">Create <img src="../images/ac.menuaro.gif"> Poly Mesh <img src="../images/ac.menuaro.gif"> Merge</span> command on the Model toolbar command to create only one mesh, as described in the
               <em class="strong">Envelopes</em> section above. 
            </p> 
            <p><span class="anchor_wrapper"><a name="GUID-DC496DED-2924-4606-B4EE-15E60A75651E"></a></span>Be aware that the scale of Maya models is often quite a lot larger than the standard
               default size of characters in Softimage. Make sure to set the scale accordingly in
               the Import FBX Options dialog box; for example, use Decimeters as the unit of scale.
               You can also parent the whole model to a null, and then scale down that null to match
               other characters you're using in CrowdFX. 
            </p> 
         </div>
         <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>Except where otherwise noted, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. Please see the <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons FAQ</a> for more information.</em></p><br></div>
   </body>
</html>