<!DOCTYPE html>

<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="SI">
      <meta name="release" content="2015">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2014-03-26">
      <meta name="topicid" content="GUID-0E9111EC-C936-439E-B444-D4EE8328F5C4">
      <meta name="indexterm" content="custom commands: creating">
      <meta name="indexterm" content="custom commands: names">
      <meta name="indexterm" content="scripts: parsing">
      <meta name="indexterm" content="parsing scripts">
      <meta name="indexterm" content="custom commands: parsing">
      <meta name="indexterm" content="arguments (in scripting): specifying while creating custom commands">
      <meta name="indexterm" content="custom commands: specifying arguments">
      <meta name="topic-type" content="concept">
      <title>Creating Non–self-installing Script-based Custom Commands</title>
      <link rel="stylesheet" type="text/css" href="../style/softimage.css"><script type="text/javascript" src="../scripts/ac_common.js"></script><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script></head>
   <body height="100%">
      <div class="body_content" id="body-content"><span class="anchor_wrapper"><a name="GUID-0E9111EC-C936-439E-B444-D4EE8328F5C4"></a></span><div class="head">
            <h1>Creating Non–self-installing Script-based Custom Commands</h1>
         </div>
         <div class="bodyProcess">
            <p><span class="anchor_wrapper"><a name="GUID-D48F0209-644E-48EA-A8A9-142EC3DB269D"></a></span>When you create a command, it becomes available to be added to a toolbar, mapped to
               a key, or used in scripts. 
            </p>
            <p><span class="anchor_wrapper"><a name="GUID-8A8C9562-6C35-43D7-BD1C-12FA26A58502"></a></span>You create a non–self-installing commmand by dragging a script to a custom toolbar
               as described in this topic. This is a simple method that does not provide many options,
               but it may be useful for beginners or for a quick solution. 
            </p>
            <p><span class="anchor_wrapper"><a name="GUID-C7C9EBD5-EA19-4F83-AE82-799DC790A43F"></a></span>However, it is recommended that you create self- installing custom commands instead.
               See the Custom Commands [SDK Guide]. 
            </p>
            <div><span class="anchor_wrapper"><a name="GUID-BF403B44-15DF-4016-8D5D-312D0180AB34"></a></span><div class="note-note"><span class="label">NOTE:</span> 
                  <p><span class="anchor_wrapper"><a name="GUID-FEEFD23D-7BBC-48C0-BEE9-B991C0C75BF0"></a></span>If you want to add a custom command to other toolbars, see <span class="char_link"><a href="toolbars_shelves_CustomToolbars.htm#WSE196D00A0F2A86418E62DD8596A29196-000D">Adding Commands to Toolbars</a></span>. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-C99149E1-C5F4-4F1E-BEF9-46014293CFF4"></a></span>If you have already created a command for a script and you drag the script instead
                     of the command onto a second toolbar, then you are creating a second command and must
                     provide a unique command name for scripting. This means that different commands are
                     logged when you click on the different buttons. 
                  </p> 
               </div>
            </div><span class="anchor_wrapper"><a name="GUID-EED22E2F-A586-4FFD-BB81-39C47804ACBD"></a></span><ol type="1" start="1">
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-5F9298EA-D0AD-4513-A295-A96E6E0A0723"></a></span>Make sure that a custom toolbar (or a toolbar tab in a shelf) is displayed. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-90B1A30D-E811-4CC2-9D2A-FAB254C4272D"></a></span>To display an existing custom toolbar, choose it from the <span class="MenuCascade" id="GUID-4D79E798-A64D-4919-AFE2-F24CF6A43396">View <img src="../images/ac.menuaro.gif"> Toolbars</span> menu on the main menu. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-E5BA80D0-B0B1-4FD2-B1D5-C3D86144A46A"></a></span>For more information about custom toolbars in general, see <span class="char_link"><a href="custom_toolbars_shelves.htm">Toolbars and Shelves</a></span>. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-A07A7940-22F6-4D4E-A35A-4F6A8B9DE1EE"></a></span>Do one of the following: 
                  </p> <span class="anchor_wrapper"><a name="UL_F9BC17DEB12144E28A471FD37508239F"></a></span><ul>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-C9A600EE-A3F7-47AD-B9AE-58C39A262213"></a></span>Select one or more lines in the history or editing pane of the script editor and drag
                           them onto the custom toolbar. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-3A896FA2-D999-4BA4-ADE4-9F83F9857EEB"></a></span>Note that text dragged from the editing pane is removed. To leave it in place, Ctrl+drag
                           it onto a toolbar instead. You can also drag text from any program that supports drag-and-drop
                           actions on Windows. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-3A218C89-8ADC-4019-8F14-AF318CB74D77"></a></span>Note also that when dropping text onto a toolbar, if the text ends with ".preset"
                           and the preset file can be loaded, then Softimage assumes you are creating a button
                           for a preset. In all other cases, Softimage assumes you are creating a button for
                           a script. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-7097648B-1EDD-4CA4-8EE0-8B2F5DEFE6F5"></a></span> <em class="mild">or</em> 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-3B6003E0-8F0D-40F2-A1D0-2B241CDE38C7"></a></span>Drag a saved script file from a browser onto your toolbar. On Windows, you can also
                           drag from a folder window. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-ED836B20-7563-4946-9754-184DCCA734BC"></a></span> <em class="mild">or</em> 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-59338EB2-0759-47D3-9575-44B1896E7173"></a></span>Drag a link to a script file from a Netview onto your toolbar. 
                        </p> 
                     </li>
                  </ul> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-F32BA5CC-DA4E-4D82-8C92-072CB20228EA"></a></span>When prompted, choose <span class="MenuCascade" id="GUID-160018F6-395C-44F3-9972-B408F11487D7">Script Command (external file)</span> and click OK. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-5B6BD9C8-90B8-4E84-9D0E-9BD4A06A3655"></a></span><div class="note-note"><span class="label">NOTE:</span>If you choose <span class="MenuCascade" id="GUID-66D0882C-7DDF-4184-98E3-6DB442BF24F6">Script Button</span>, a button is created that holds the lines of script. It does not create a command
                        that you can assign to keys or use in other scripts. 
                     </div>
                  </div> 
                  <p><span class="anchor_wrapper"><a name="GUID-BF37275F-635F-4365-9930-92D1F03361D4"></a></span>The Add Script Command dialog box opens. 
                  </p> 
                  <div class="figure-anchor"><img src="../images/GUID-DD258EF4-769C-40EC-B378-90774E9BF301-low.png"></div> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-8F30DE0D-270F-45FF-9094-8E71210219B7"></a></span>Specify a <span class="MenuCascade" id="GUID-2DE428D8-B15B-41D2-A7B3-8F0F5D2E0E5D">Command/Button Name</span> for the script. This is the text that will appear as a label on the button. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-57879304-274C-4DB4-A9F2-3CC39108AB91"></a></span>If you dragged lines from the script editor, the default command name is of the form
                     Scriptnumber; if you dragged a saved script file, the default is the file name. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-700A8D6C-CAE0-4202-872F-9227E82810BC"></a></span><div class="note-tip"><span class="label">TIP:</span>If the Command/Button Name contains spaces, then it can be split and displayed on
                        two lines on a button. 
                     </div>
                  </div> 
                  <div class="figure-anchor"><img src="../images/GUID-A856F880-A054-4AA3-96AD-332A71EACEBB-low.png"></div> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-16D9F6E5-8CFB-49AD-B525-B818D85DB01F"></a></span>Specify a <span class="MenuCascade" id="GUID-16C2A58E-F4B8-4B37-BC13-6D8E016EBE3F">Script Command Name</span>. This is the name that gets logged to the command history when you click the button.
                     
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-98F28404-A067-4961-84BB-B2D6FB867F28"></a></span>You can also use this name to invoke your custom command from within another script.
                     The command name for scripting cannot use spaces or punctuation. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-F56C7732-65A3-4D85-A94C-A9298B3C3A91"></a></span>You can also provide a brief <span class="MenuCascade" id="GUID-D08CBFED-4D46-407A-ABD4-E76FA4B877B0">Description</span>. This description is displayed in the Customize Toolbar dialog box if you later add
                     the command to other toolbars as described in <span class="char_link"><a href="custom_commands_RunningCustomCommands.htm#WS8365E4DEE3D7EE45B994942AEEC3E767-000D">Running Commands from Custom Toolbars</a></span>. It is also displayed in the Keyboard Mapping dialog box — see <span class="char_link"><a href="custom_commands_RunningCustomCommands.htm#WS8365E4DEE3D7EE45B994942AEEC3E767-000E">Running Commands from Keys</a></span>. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-C0F6F6B4-BB2F-49F7-A443-1948FF94C27A"></a></span>Specify the file name for the script, including the path. If you dragged lines from
                     the script editor, a default file name is supplied. If you dragged a script file,
                     it is copied to the location and file name you specify. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-251FDD23-7326-4137-9A8D-ADCE838A201F"></a></span>If necessary, select the scripting language from the pop-up list in the <span class="MenuCascade" id="GUID-C03325AD-A61E-4DBD-A6AC-8450CC86CDCE">Language</span> box. The box lists the supported languages that are installed on your computer. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-673D5AEF-29BD-4F23-A7D0-C75CE2201B42"></a></span>If you dragged lines from the script editor onto the toolbar, the default language
                     is the one specified in your preferences. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-BCF4947F-EFAD-4A14-B56C-03E2665F8761"></a></span>If you dragged a saved file, the default language is based on the file name extension:
                     <span class="MenuCascade" id="GUID-92C0A3E8-757A-489E-9595-C49BC158E5A3">.vbs</span> for VBScript, <span class="MenuCascade" id="GUID-3B6B68BE-D9BB-4C37-A87C-AF7E48A53E84">.js</span> for JScript, <span class="MenuCascade" id="GUID-5D1E9C52-C69E-45D4-8218-BFB35C84F15A">.pls</span> for PerlScript, and <span class="MenuCascade" id="GUID-DFE30943-BC2B-4F19-B69B-298857043291">.pys</span> for Python ActiveX Scripting Engine. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-241C061A-7C80-4FDF-9875-1688C8F6EF71"></a></span>If your script does not contain any procedures, there is nothing more to do — click
                     OK to close the Add Script Command dialog box and add the button to your toolbar.
                     
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-1A0ED090-EBA8-4A88-B2BD-56E2BA042F88"></a></span>If your script does contain procedures and you want to call them instead of global
                     code (that is, script fragments that appear outside of a discrete function or subroutine),
                     continue with the rest of these steps. 
                  </p> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-7D0EB96E-F9CD-4389-B712-E96F03F55C9E"></a></span>Click the <span class="MenuCascade" id="GUID-243321C5-BFB0-4677-A9A1-ED7471BF43E7">Parse</span> button. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-41454349-0CE0-494B-9676-2C23D5490842"></a></span>This parses the script and finds the procedures and arguments. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-4A773571-B701-47AB-B1E8-3AF6414D42F7"></a></span><div class="note-important"><span class="label">IMPORTANT:</span>Parsing a script may execute global code, that is, any code that is not within a defined
                        procedure. It will also run procedures that are called from global code. 
                     </div>
                  </div> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-CCF1D212-90D5-4113-9A8B-9A70B8E0DABA"></a></span>If your script contains procedures, you can specify which procedure to execute when
                     the button is clicked. Select the desired procedure from the pop-up list in the <span class="MenuCascade" id="GUID-421DE609-AD97-4EFB-A55C-7EBBEBEFA881">Script Procedure</span> box. 
                  </p> 
                  <p><span class="anchor_wrapper"><a name="GUID-C8E2809C-A566-40AA-A6FD-8B5A1E99CE9F"></a></span>If you do not specify a procedure, only global code (script fragments that appear
                     outside of a function or subroutine) is executed, as well as any procedures that are
                     called from global code. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-897FD41F-9E4D-458A-862C-D4EA580CCE08"></a></span><div class="note-important"><span class="label">IMPORTANT:</span>Even when a procedure is specified, global code may be executed before the procedure
                        is called. This is a side-effect of parsing the script with some scripting engines.
                        To be certain that your script behaves predictably in all situations, do not mix global
                        code and procedures in a script file when defining custom commands. 
                     </div>
                  </div> 
                  <div><span class="anchor_wrapper"><a name="GUID-988529F3-F68C-4DDE-B24B-9D909930BE46"></a></span><div class="note-note"><span class="label">NOTE:</span>For some scripting languages, such as PerlScript and Python, Softimage cannot find
                        the procedures automatically. In these cases you must type the procedure name into
                        the <span class="MenuCascade" id="GUID-7CE47BE4-EE11-4F1C-A942-F08D323873E8">Script Procedure</span> box manually. 
                     </div>
                  </div> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-49935918-2661-4FC4-85E6-2B71B736B35D"></a></span> If the selected procedure contains arguments, they are listed under <span class="MenuCascade" id="GUID-C10730C6-302E-451F-BF55-D494B9D109AB">Parameters</span>. For each argument, enter a value in the corresponding <span class="MenuCascade" id="GUID-AD69F64D-9E0D-4732-BB2E-FF93231DB495">Value</span> box. This value is used when you click the button to run the script. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-72FA737C-49D9-450D-A513-CF623FD3C688"></a></span><div class="note-note"><span class="label">NOTE:</span> <span class="anchor_wrapper"><a name="UL_EE059F72917D4DF697FE8C80CD070FC3"></a></span><ul>
                           <li> 
                              <p><span class="anchor_wrapper"><a name="GUID-5E5FB0BB-57D6-4370-BABC-85AA7A2F3342"></a></span>For some scripting languages, such as PerlScript and Python, you need to add parameters
                                 manually. 
                              </p> 
                           </li>
                           <li> 
                              <p><span class="anchor_wrapper"><a name="GUID-56D0DC3E-8EF4-4925-9323-119EE088129B"></a></span>You can use the <span class="MenuCascade" id="GUID-AEF48CF5-F231-489A-A39A-0F51CD4A7D33">New</span> button to add a parameter to the <span class="MenuCascade" id="GUID-1DEEA687-AE79-4D11-A39E-40F6088E86EF">Parameters</span> list. 
                              </p> 
                           </li>
                           <li> 
                              <p><span class="anchor_wrapper"><a name="GUID-3354DDDB-B513-4EB0-A3CF-19F60F484810"></a></span>To change the order, select a parameter and click the arrow buttons. To delete a parameter,
                                 select it and click the delete button (<span class="MenuCascade" id="GUID-508A35B6-511C-4C1E-9E1E-44F2BD7CB687">X</span>). 
                              </p> 
                              <div class="figure-anchor"><img src="../images/GUID-2E693E73-1C0B-41F8-AC88-8149237FE969-low.png"></div> 
                           </li>
                        </ul> 
                     </div>
                  </div> 
               </li>
               <li> 
                  <p><span class="anchor_wrapper"><a name="GUID-A1377212-EE66-46DA-A243-696C3874B423"></a></span>Click OK. The Add Script Command dialog box closes and the new button is added to
                     your custom toolbar. 
                  </p> 
               </li>
            </ol>
         </div>
         <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>Except where otherwise noted, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. Please see the <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons FAQ</a> for more information.</em></p><br></div>
   </body>
</html>