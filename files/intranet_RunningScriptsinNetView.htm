<!DOCTYPE html>

<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="SI">
      <meta name="release" content="2015">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2014-03-26">
      <meta name="topicid" content="GUID-A1AA7A5D-9BFD-4E64-B9D0-0F2029E42E48">
      <meta name="indexterm" content="netview: running scripts">
      <meta name="indexterm" content="scripts: in netview">
      <meta name="topic-type" content="concept">
      <title>Running Scripts in Netview</title>
      <link rel="stylesheet" type="text/css" href="../style/softimage.css"><script type="text/javascript" src="../scripts/ac_common.js"></script><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script></head>
   <body height="100%">
      <div class="body_content" id="body-content"><span class="anchor_wrapper"><a name="GUID-A1AA7A5D-9BFD-4E64-B9D0-0F2029E42E48"></a></span><div class="head">
            <h1>Running Scripts in Netview</h1>
         </div>
         <div class="bodyProcess">
            <p><span class="anchor_wrapper"><a name="GUID-99B01FA5-31BA-46CE-BA97-3155C0FFCF31"></a></span>You can create Netview pages that not only set data in Softimage, but also get data
               from Softimage and display dynamic info. For example, you can write a suite of scripts
               for custom tools, and build the user interface with dynamic HTML, forms, and buttons
               in a Web page. There's no end to the possibilities, but this section should help you
               get started. 
            </p>
            <div><span class="anchor_wrapper"><a name="GUID-8844A989-0A50-4EC8-8343-15E939CAF104"></a></span><div class="note-note"><span class="label">NOTE:</span>To run simple scripts from a Netview page as if they were running from the script
                  editor, see <span class="char_link"><a href="intranet_LinkingtoFilesinNetView.htm#WS301854B6F7CD754D9022B9345252DF8A-0008">Linking to Scripts</a></span>. 
               </div>
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-000B"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-22674FC1-D1FC-444B-8E20-F9B27ECF60AD"></a></span>Setting Security
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-A741FC32-ED5A-4A22-8F25-34AC81AE415B"></a></span>Before you can run scripts from Netview, you must set the appropriate security level
                  to <span class="MenuCascade" id="GUID-7AA40F4D-9A02-4112-8BE6-A35415CF21C7">Low</span> for the domains on which the scripts reside. Low security allows all scripts and
                  ActiveX content to run; to interact with Softimage, scripts must instantiate the XSI.Application
                  ActiveX object. 
               </p> 
               <div><span class="anchor_wrapper"><a name="GUID-FFF44DF2-5653-4CC3-8C25-9ACCAD74C693"></a></span><div class="note-important"><span class="label">IMPORTANT:</span>Be very careful about which domains you set to low security. Malicious ActiveX content
                     can damage your systems and data. It is strongly recommended that you use this setting
                     for specific addresses on your private intranet only. 
                  </div>
               </div> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-000C"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-41F7A0A8-1AA5-46BC-97D4-044362940FD2"></a></span>To set Internet security levels on Windows
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-838E3296-83E0-4DD1-82FD-013DD9C04CED"></a></span>On Windows, you can set the security level for a specific domain in either of two
                     ways: 
                  </p> <span class="anchor_wrapper"><a name="UL_27131672841F49DAA7309A7F2BE933AB"></a></span><ul>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-F03C2047-D79C-40BF-A76F-302D9462A08B"></a></span>From within Internet Explorer. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-87A8F2A1-EEE6-42AE-AFC2-2B4280F7CCB7"></a></span> <em class="mild">or</em> 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-0C937DCB-A3A6-4AA9-81F9-FDAE74CB0047"></a></span>From the Windows Control Panel. 
                        </p> 
                     </li>
                  </ul> 
                  <p><span class="anchor_wrapper"><a name="GUID-79D8D85C-C752-43FC-B4FA-67CEC3640AF2"></a></span>The exact procedure depends on the versions of Windows and Internet Explorer that
                     you are using, so consult Internet Explorer's online help for details. 
                  </p> 
                  <div><span class="anchor_wrapper"><a name="GUID-7C5A0827-E6D1-4A94-9936-689EA39B392F"></a></span><div class="note-important"><span class="label">IMPORTANT:</span>Modifying the security setting for a domain affects all programs on your computer,
                        not just Softimage. 
                     </div>
                  </div> 
               </div> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-000D"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-E63E21A3-3AB2-4A13-B238-6219FA9FE589"></a></span>To set Internet security levels on Linux
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-4D40B6FD-78E3-4826-94EF-C58591959639"></a></span>On Linux, you can set the security level for a specific domain using the Mainwin Control
                     Panel: 
                  </p> <span class="anchor_wrapper"><a name="GUID-AEC243F3-43AC-4B13-9154-43E9B4411962"></a></span><ol type="1" start="1">
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-4258A84C-17B0-4536-8D19-92D99F726A95"></a></span>Open a terminal or shell window. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-C2DB5C62-50E6-497B-B219-DF0D5280DD0B"></a></span>Source the Softimage environment script by typing: 
                        </p> <span class="code"> source ~/<span class="charspan-emphasis">.xsi_2013</span></span> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-56FB7088-9F7E-4FC4-8E89-27FCC35D8D80"></a></span>Launch the MainWin Control Panel by typing: 
                        </p> <span class="code"> mwcontrol</span> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-B31B92BF-FEB2-4CA8-8D56-7D2A7697E79E"></a></span>Double-click on the Internet Options icon. The Internet Properties dialog box opens.
                           
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-83DD74C2-C750-4F08-96F1-C254CEEBF324"></a></span>On the Security tab, select <span class="MenuCascade" id="GUID-BAA8BEC7-A630-41E7-8990-A955EE2B71FE">Trusted sites</span> and then click the <span class="MenuCascade" id="GUID-B764C271-2408-41B4-9A72-759E38C3F925">Sites</span> button. The Trusted sites dialog box opens. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-ABFE40AC-98B2-4D12-B84C-C88332626A62"></a></span>Type a domain address and click <span class="MenuCascade" id="GUID-05C8344B-9814-4400-94F3-88769DA8B856">Add</span>. 
                        </p> 
                     </li>
                  </ol> 
               </div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-000E"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-3DBFADEC-DED0-44BB-A468-872C708642BA"></a></span>Running Embedded Scripts Automatically
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-404FDA0A-4A10-44FE-B22C-8D1595AE35C3"></a></span>Scripts that are embedded in the body of an HTML page are parsed and run automatically
                  when the page is loaded into Netview. Global code (that is, code that is not within
                  any procedure) is executed, together with functions or subroutines that are called
                  from the global code. 
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-BBE25884-2EB3-4F1F-80B6-57746BD4B427"></a></span>For example: 
               </p> 
               <div class="codeBlock"><pre>
&lt;body&gt;
&lt;!-- HTML elements go here --&gt;
...
&lt;script language="vbscript"&gt;
'Global code 
'This gets executed automatically
...
sub mySub()
'This procedure is executed only when it is called
...
end sub
&lt;/script&gt;
&lt;!-- More HTML elements go here --&gt;
...
&lt;/body&gt;</pre></div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-000F"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-F30CA423-3194-4F84-87DD-BFC3D835151D"></a></span>Running Embedded Script Code from Buttons and Hotspots
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-4077AB3D-D5FD-4CBD-B55B-5EBEB258CA8A"></a></span>You can run script code when your users click a button or hotspot on the HTML page.
                  To do this, write a procedure and then call the procedure from the <span class="MenuCascade" id="GUID-65FE3A04-8734-4733-88AC-6D34CD79FB7C">onclick</span> event of the button or hotspot. 
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-62B0E9E6-2375-48A8-8583-E065F1631229"></a></span>For example, to create an HTML button that runs mySub using VBScript: 
               </p> 
               <div class="codeBlock"><pre>
&lt;script language="vbscript"&gt;
...

sub mySub()
'Code goes here
end sub
...

&lt;/script&gt;
...

&lt;input id=bClickMe
		type=button
		value="Click Me"
		name=button1
		language=vbscript
		onclick="mySub()"&gt;</pre></div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0010"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-970011DB-A231-429B-B273-3DB36B6D85BB"></a></span>Communicating with Softimage
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-8D35A9B3-B087-4882-8F93-7C92A5DD139F"></a></span>Your Netview script must link to Softimage before it can get and set data. This is
                  because a script in Netview is actually running inside Internet Explorer, and therefore
                  needs to get a pointer to Softimage before it can communicate. To get the pointer,
                  your script must instantiate the XSI.Application object. 
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-DBF1EFBD-AAA3-4925-A6E0-43897FB99012"></a></span>For in example, in VBScript: 
               </p> 
               <div class="codeBlock"><pre>
On Error Resume Next

Set myXSI = CreateObject("XSI.Application")
Set myApp = myXSI.Application

if err.number &lt;&gt; 0 then
	document.write "Open this page in Softimage's Netview."
end if</pre></div> 
               <p><span class="anchor_wrapper"><a name="GUID-93280358-9AF2-4B0C-A5B7-D088288D9844"></a></span>Once you have a pointer to XSI.Application, you can prepend it to the name of any
                  object, method, or property in the Softimage object model. For example, to get the
                  current selection in Softimage using VBScript: 
               </p> 
               <div class="codeBlock"><pre>
Set mySel = myApp.Selection</pre></div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0011"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-53A3809B-352A-42D7-B805-AD05351490E0"></a></span>Running Softimage Script Commands
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-D7DBF305-5B21-4628-837C-F5B8A4677A73"></a></span>Getting a pointer to the XSI.Application object, as described in the previous section
                  <span class="char_link"><a href="intranet_RunningScriptsinNetView.htm#WS301854B6F7CD754D9022B9345252DF8A-0010">Communicating with Softimage</a></span>, allows you to use Softimage objects, methods, and properties in your Netview scripts.
                  But what if you need to use a Softimage script command for which there is no equivalent
                  in the object model? Luckily, there are a few ways to accomplish this. 
               </p> 
               <div><span class="anchor_wrapper"><a name="GUID-F5D11381-C6DB-40A1-ABD2-CDE9FA9FFDC7"></a></span><div class="note-note"><span class="label">NOTE:</span>Some "commands", like LogMessage and Version, are actually methods of the Application
                     object. You can run these methods without any workaround. 
                  </div>
               </div> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0012"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-6BAB8DAC-1973-428D-8D6D-282B7F76E9F7"></a></span>Running script commands via COM automation
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-65CE0C54-CD7F-4DAA-8452-73D96305A185"></a></span>Once you have a pointer to XSI.Application, you can use it to run any Softimage script
                     command via COM automation. For example: 
                  </p> 
                  <div class="codeBlock"><pre>
'Get a pointer to XSI.Application
Set myXSI = CreateObject("XSI.Application")
Set myApp = myXSI.Application
'Get the selection
Set mySel = myApp.Selection
'Run a command, e.g. InspectObj
myApp.InspectObj(mySel(0))</pre></div> 
               </div> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0013"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-458E4BCA-1359-49D0-8C29-4A295602654D"></a></span>Running script commands with ExecuteScriptCommand
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-33666C4D-D970-4C09-BB5D-695B92E8A0A9"></a></span>The ExecuteScriptCommand method of the XSIApplication object lets you run Softimage
                     scripting commands, including custom commands. Although this method is primarily intended
                     to run commands from COM C++, you can also use it in Netview. You must package the
                     arguments in an array beforehand. For more information see ExecuteScriptCommand [SDK
                     Guide]. 
                  </p> 
               </div> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0014"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-15849069-8764-4F60-AC00-8B843A93CB2A"></a></span>Running script files with ExecuteScript
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-16D78123-1A7C-4972-AF56-9B19F7171DA0"></a></span>The ExecuteScript method of the XSIApplication object lets you run a script file rather
                     than a single Softimage scripting command. You must package the arguments in an array
                     beforehand. For more information see ExecuteScript [SDK Guide] 
                  </p> 
               </div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0015"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-840E26F0-4C5F-4FFA-947C-2D28DE14586A"></a></span>Displaying Data Dynamically
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-FB9B471E-28B2-4BD7-AB42-D0D842DAF836"></a></span>You can display information from Softimage dynamically in a Netview page. 
               </p> <span class="anchor_wrapper"><a name="GUID-2798DD6F-8DE7-42AC-89F7-E48EFCE68919"></a></span><ol type="1" start="1">
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-D76C58AD-3466-4205-8711-5108444A8FE1"></a></span>Create a &lt;div&gt; element in the body of the HTML to hold the data that you will write,
                        and give it a unique ID. For example: 
                     </p> <span class="code"> &lt;div id="myDiv"&gt; &lt;/div&gt;</span> 
                     <p><span class="anchor_wrapper"><a name="GUID-E6DA88B2-C0FE-470E-B50B-A92AB7A29154"></a></span>If desired, you can put default text or other HTML elements between the opening and
                        closing div tags. 
                     </p> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-2CBAB470-75BE-4B10-8E1A-DA6DB375FFDC"></a></span>Write a routine that builds a string of text in HTML format and assigns it to the
                        innerHTML property of the &lt;div&gt;. 
                     </p> 
                     <p><span class="anchor_wrapper"><a name="GUID-45059208-62D9-478B-B13D-B7EC887644AC"></a></span>For example in VBScript: 
                     </p> 
                     <div class="codeBlock"><pre>
Sub writeSel()

Set mySel= myApp.Selection

if mySel.Count &lt;&gt; 0 then
	myStr = ""
	for each thing in mySel
		myStr = myStr &amp; "&lt;p&gt;My name is &lt;b&gt;" &amp; thing.Name &amp; "&lt;/b&gt;.&lt;/p&gt;"
	next
else
	myStr= "&lt;p&gt;Select an object first.&lt;/p&gt;"
end if

myDiv.innerHTML= myStr
End Sub</pre></div> 
                  </li>
                  <li> 
                     <p><span class="anchor_wrapper"><a name="GUID-A00351AB-3D85-4231-B40A-B2439A80AA66"></a></span>Call the routine in some way. For example, to make a button that calls a VBScript
                        subroutine: 
                     </p> 
                     <div class="codeBlock"><pre>
&lt;input id=bWhoAmI
		type=button
		value="Who am I?"
		name=button1
		language=vbscript
		onclick="writeSel()"
		&gt;</pre></div> 
                  </li>
               </ol> 
               <div class="section"><span class="anchor_wrapper"><a name="WS301854B6F7CD754D9022B9345252DF8A-0016"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-C4FC5DEA-0FDE-40F6-BA70-F857959A6F39"></a></span>Sample Dynamic HTML Page
                  </h3> 
                  <p><span class="anchor_wrapper"><a name="GUID-B28E20D3-74A8-411C-8866-6A9B4637B1C6"></a></span>Look in the Netview Help page for a simple example of a page that gets a pointer to
                     Softimage, runs a script from a button, and prints the name of the selected object
                     dynamically. 
                  </p> 
               </div> 
            </div>
         </div>
         <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>Except where otherwise noted, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. Please see the <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons FAQ</a> for more information.</em></p><br></div>
   </body>
</html>