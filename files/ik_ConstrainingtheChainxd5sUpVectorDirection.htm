<!DOCTYPE html>

<!-- saved from url=(0024)http://docs.autodesk.com -->
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta name="product" content="SI">
      <meta name="release" content="2015">
      <meta name="book" content="GeneralUser">
      <meta name="created" content="2014-03-26">
      <meta name="topicid" content="GUID-5F562995-922F-4E12-AA71-C398EC3DF2CD">
      <meta name="indexterm" content="up vectors: constraints for chains">
      <meta name="indexterm" content="constraints: up-vector for chains">
      <meta name="indexterm" content="chains: up-vector constraints (up direction)">
      <meta name="topic-type" content="concept">
      <title>Constraining the Chain's Up Vector (Direction)</title>
      <link rel="stylesheet" type="text/css" href="../style/softimage.css"><script type="text/javascript" src="../scripts/ac_common.js"></script><script type="text/javascript" src="../scripts/utils/adsk.redirect.js"></script></head>
   <body height="100%">
      <div class="body_content" id="body-content"><span class="anchor_wrapper"><a name="GUID-5F562995-922F-4E12-AA71-C398EC3DF2CD"></a></span><div class="head">
            <h1> Constraining the Chain's Up Vector (Direction)</h1>
         </div>
         <div class="bodyProcess">
            <p><span class="anchor_wrapper"><a name="GUID-5573E4C7-8874-4C17-BB67-0D9FA2F6563E"></a></span>Using a special up-vector constraint designed only for IK chains, you can constrain
               the orientation of a chain to prevent it from flipping. This constraint provides full
               and precise control of the general orientation of your chain's resolution plane and
               helps you control where flipping problems will occur. You add up-vector constraints
               to the first bone of a chain because that is the bone that determines the chain's
               resolution plane. If you set an up-vector constraint for a bone that is not the first
               bone in the chain, a subchain is created starting at that bone's joint. 
            </p>
            <p><span class="anchor_wrapper"><a name="GUID-C8E3BBDC-DD54-41C0-9F2C-EC8A702CCB28"></a></span>Using the chain's up-vector constraint forces the Y axis of a chain or subchain's
               first joint to point to a constraining object. The location of the chain's effector
               determines the X axis of the resolution plane and the Z axis is perpendicular to the
               plane defined by the X and Y axes. 
            </p>
            <p><span class="anchor_wrapper"><a name="GUID-DF922E89-2889-4ED8-9D9E-9DAF35071393"></a></span>The up-vector constraint specifies the third point of the resolution plane of the
               chain, while the first two points are the positions of the first joint and the effector.
               
            </p><span class="anchor_wrapper"><a name="FIG_491B2646E4704019AD6B917979E74B84"></a></span><div class="figure-anchor"><img src="../images/GUID-D47F4258-B4A1-4F57-A1A8-7A077242AA54-low.png"></div><span class="anchor_wrapper"><a name="TABLE_F2A165F6C639436B86B6B52847F7CF13"></a></span><div class="table_Ruled">
               <table cellpadding="0" cellspacing="0" class="ruled">
                  <colgroup>
                     <col align="left">
                     <col align="left">
                  </colgroup>
                  <tr class="ruledOddRow">
                     <td class="table-body"> <span class="anchor_wrapper"><a name="GUID-D7E4A2BC-06F7-49EC-A753-F32EB2DBC027"></a></span><p class="table-body"> <span class="MenuCascade" id="GUID-E9AE40BB-989A-44AC-920D-AE95B5D521B4">A</span> 
                        </p> 
                     </td>
                     <td class="table-body" align="left"> <span class="anchor_wrapper"><a name="GUID-99F56664-502F-4CC9-B84C-8589CE66C6DE"></a></span><p class="table-body">First point (joint 1) </p> 
                     </td>
                  </tr>
                  <tr class="ruledEvenRow">
                     <td class="table-body"> <span class="anchor_wrapper"><a name="GUID-45F66108-4633-4318-85C0-BF8F97E98E4F"></a></span><p class="table-body"> <span class="MenuCascade" id="GUID-9B1BAEE7-81BE-4859-8185-6DCD04F4ABDB">B</span> 
                        </p> 
                     </td>
                     <td class="table-body" align="left"> <span class="anchor_wrapper"><a name="GUID-F486732B-8DDB-4216-8635-B3A4855B9C45"></a></span><p class="table-body">Second point (effector) </p> 
                     </td>
                  </tr>
                  <tr class="ruledOddRow">
                     <td class="table-body"> <span class="anchor_wrapper"><a name="GUID-09928598-C574-4F2C-A2D2-DC5FB93E2455"></a></span><p class="table-body"> <span class="MenuCascade" id="GUID-048D49FD-9E37-49E3-9AC5-E9D3439F62D8">C</span> 
                        </p> 
                     </td>
                     <td class="table-body" align="left"> <span class="anchor_wrapper"><a name="GUID-43730A3A-B94A-4A0F-A72B-8F4829287BB8"></a></span><p class="table-body">Third point (Up-vector constraint) </p> 
                     </td>
                  </tr>
                  <tr class="ruledEvenRow">
                     <td class="table-body"> <span class="anchor_wrapper"><a name="GUID-66CEB54D-B3DC-4A24-8C83-EE49CD188E66"></a></span><p class="table-body"> <span class="MenuCascade" id="GUID-3C906BD9-17B0-44E0-A25B-3729D2543BD5">D</span> 
                        </p> 
                     </td>
                     <td class="table-body" align="left"> <span class="anchor_wrapper"><a name="GUID-5FC98DCB-A022-46FD-8D42-225024C348B3"></a></span><p class="table-body">Resolution plane (triangle) </p> 
                     </td>
                  </tr>
               </table>
            </div>
            <div><span class="anchor_wrapper"><a name="GUID-93850476-171E-482D-8A7E-33C70648F119"></a></span><div class="note-tip"><span class="label">TIP:</span> <span class="anchor_wrapper"><a name="UL_CC28689C60D44E31B83493F9D5E0A505"></a></span><ul>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-EA457371-3CD1-4935-BBA5-B53E987DBF53"></a></span>To view the up-vector constraint in the viewport, select <span class="MenuCascade" id="GUID-9931CFC9-B848-423B-B6BD-6AF2C82F0556">Chain Critical Zone</span> on the Attributes page in the viewport's Camera Visibility property editor (see <span class="char_link"><a href="skel_DisplayingChainElements.htm#WSA6148FF52F63AE42885097A8A1DB2837-0032">Displaying Critical Zones for IK Chains</a></span>). 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-554908B2-ABD8-4B9E-8889-37D637A6DA5D"></a></span>To see how up vector controls work in a rig, create a default rig for a character
                           and then translate the pyramid-shaped controls behind the elbows and knees. See <span class="char_link"><a href="char_rig_CreatingaBipedorBipedDogLegRig.htm">Creating Biped Rigs</a></span>. 
                        </p> 
                     </li>
                  </ul> 
               </div>
            </div>
            <p><span class="anchor_wrapper"><a name="GUID-0814E30B-AA41-40DA-9676-C0894AEF7EA8"></a></span>The chain's up-vector constraint is different from a "regular" constraint (as found
               in the Constrain menu) because it's not a constraint per se: it is actually a property
               of the chain's joint. This means that the up-vector can be duplicated as part of a
               chain, but removing this constraint cannot be done as for normal constraints (see
               <span class="char_link"><a href="ik_ConstrainingtheChainxd5sUpVectorDirection.htm#WSF4D645293765AE498C69174E3D6620E4-005D">Removing Up Vector Constraints</a></span> for how to remove the up-vector constraint). 
            </p>
            <p><span class="anchor_wrapper"><a name="GUID-DEB7B4B3-6BAD-4486-B8A6-FE8A4521DAF5"></a></span>For more information on other constraints, see <span class="char_link"><a href="ani_constraints.htm">Animating with Constraints</a></span> [<span class="char_link"><a href="ani_cover.htm">Animation</a></span>]. 
            </p>
            <div><span class="anchor_wrapper"><a name="GUID-94C719AB-C849-4B62-93A5-F7C4046D6823"></a></span><div class="note-note"><span class="label">NOTE:</span> <span class="anchor_wrapper"><a name="UL_66DBE853FAE445D7874FC1891AC153A9"></a></span><ul>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-647BF54C-5565-49D9-BB33-680AD2103EF2"></a></span>If you perform any action that controls the bone's orientation (key the rotation,
                           use an orientation constraint, or use an expression on the rotation), it takes precedence
                           over the up-vector constraint. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-2CA9CA43-3B5C-4D02-9AAF-F909D198E0BD"></a></span>If you have both a preferred axis and up-vector constraints on a chain, the last one
                           applied takes precedence. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-70B2F224-3068-4D72-B1C2-15C699E7BB5A"></a></span>If a bone is not moving with the up-vector constraint, it may be that its rotation
                           is animated (FK) which overrides the constraint. 
                        </p> 
                     </li>
                  </ul> 
               </div>
            </div>
            <p><span class="anchor_wrapper"><a name="GUID-D3F61A3D-14D9-4C60-8DDC-5268478C69C8"></a></span>You can set the up-vector constraint using either a menu command or from the Kinematic
               Joint property editor, depending on whether you are using a separate constraining
               object or not. 
            </p>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0056"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-E4E33363-0A93-40F9-89F9-BE2AB0ECDE30"></a></span>Constraining the Up Vector to an Object
               </h2> 
               <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0057"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-FE8B8D30-BD40-466B-890A-26C22D336EC3"></a></span>To constrain the bone's up-vector to a control object
                  </h3> <span class="anchor_wrapper"><a name="GUID-9BC55E83-1D70-4235-A9CD-28F97263AF06"></a></span><ol type="1" start="1">
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-9A27D255-0357-43D2-9D5D-4CB6BD78ECF8"></a></span>Create a constraining (control) object (such as a null) and position it as close as
                           possible to the chain's root. If you place it too far from the root, you may get undesirable
                           results. 
                        </p> 
                        <div><span class="anchor_wrapper"><a name="GUID-CB662AF8-C551-498E-8F50-BA1E9832495A"></a></span><div class="note-tip"><span class="label">TIP:</span>To quickly create a null, you can choose <span class="MenuCascade" id="GUID-85D19B5E-CD1A-4A32-952F-85A01F0EC245">Create <img src="../images/ac.menuaro.gif"> Skeleton <img src="../images/ac.menuaro.gif"> Draw 2D Chain</span> and click once, then right-click to end chain drawing. The advantage is that the
                              null is placed where you click, not at the global origin (0,0,0,) and you can translate
                              it immediately. 
                           </div>
                        </div> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-365A9339-7E84-4E57-9AD8-080E004F977D"></a></span>Select the first bone of the chain and choose <span class="MenuCascade" id="GUID-B116AF78-FC01-463F-8661-CCEAC5F6C064">Create <img src="../images/ac.menuaro.gif"> Skeleton <img src="../images/ac.menuaro.gif"> Chain Up Vector</span> from the Animate toolbar, or choose <span class="MenuCascade" id="GUID-3E4F4715-0CF8-4391-9260-06F762E55CC9">Constrain <img src="../images/ac.menuaro.gif"> Chain Up Vector</span> from the Constrain panel. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-B60261AB-478F-42EA-926B-826FB6F8A98D"></a></span>You always add up-vector constraints to the first bone of a chain because that is
                           the bone that determines the chain's resolution plane. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-2A58EC4F-5A5F-43A3-B316-01B5B72B0FF4"></a></span>Pick the control object. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-83DF31D5-ADE6-4EEC-94CE-247EEB702EA5"></a></span>You will see the position in the Up Vector XYZ settings on the Resolution Plane page
                           (see next page) but you won't be able to move the object using those settings: they
                           only indicate the position of the control object. 
                        </p> 
                     </li>
                  </ol> 
               </div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0058"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-62EABBD0-661F-4905-879E-385E534E6D11"></a></span>Constraining the Up Vector without an Object
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-DA9E2299-945F-4508-BD56-138193907E79"></a></span>While it is common to constrain a bone's up vector to a control object, you can simply
                  make the up vector always point in a certain direction using the controls on the Resolution
                  page in the bone's Kinematic Joint property editor. This is known as a <em class="mild">static up vector</em>. 
               </p> 
               <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-0059"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-071955CC-B4E4-4916-9708-0118FE73B655"></a></span>To create a static up-vector constraint
                  </h3> <span class="anchor_wrapper"><a name="GUID-CF8329A0-AC1C-47F5-A0C1-3805155BD354"></a></span><ol type="1" start="1">
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-B91A83E4-C763-471D-BC19-B73889FE17D8"></a></span>Select the first bone of the chain and open its Kinematic Joint property editor. 
                        </p> 
                        <p><span class="anchor_wrapper"><a name="GUID-0218C76A-8DB9-4838-81B7-63587888E508"></a></span>You always add up-vector constraints to the first bone of a chain because that is
                           the bone that determines the chain's resolution plane. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-4462D3F4-8F84-46C1-843D-ECD74CEC29A2"></a></span>On the Resolution Plane page, select <span class="MenuCascade" id="GUID-D21FAE69-5D3B-494F-8422-4724863D4DFA">Up Vector</span> from the <span class="MenuCascade" id="GUID-6643833C-E4B4-4005-863B-D857100ED289">Res. Plane</span> list. 
                        </p> <span class="anchor_wrapper"><a name="FIG_A6353F07DB2845CAA779C7B6DD1203E8"></a></span><div class="figure-anchor"><img src="../images/GUID-F6201C4A-7F14-41A8-A7B9-09D7CAC309C5-low.png"></div> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-8B780F10-0323-4D6D-8FB0-6BEC482A5AC4"></a></span>Define the up-vector position values in global space using the <span class="MenuCascade" id="GUID-0C75B6F8-8EA7-4C8B-9A5F-7AA1401587D8">Up Vector X</span>, <span class="MenuCascade" id="GUID-0B2FFD69-1425-4992-A3EC-9E0D51D0B1A4">Y</span>, and <span class="MenuCascade" id="GUID-24C8790F-F16C-4687-9BAE-B3CAF927B6D5">Z</span> settings. This is the spot to which the up vector of the bone will point. 
                        </p> 
                        <div><span class="anchor_wrapper"><a name="GUID-504D3B32-AF13-4E4A-8D36-6787BDC2D2DA"></a></span><div class="note-note"><span class="label">NOTE:</span>You could set up expressions on the Up Vector X, Y, Z settings to control the up vector's
                              position. 
                           </div>
                        </div> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-CECC8FEB-476E-41FC-AEB0-03EC5A4DB019"></a></span>Select <span class="MenuCascade" id="GUID-996A94AB-E5FD-45BE-8A4A-994C044EA3D9">Use Root Coordinates</span> to specify a static up vector using the chain root's coordinates instead of global
                           coordinates. There are two main implications of using the chain root's coordinates:
                           
                        </p> <span class="anchor_wrapper"><a name="UL_88000504D3E34EA2BED29BAD4E573BC5"></a></span><ul>
                           <li> 
                              <p><span class="anchor_wrapper"><a name="GUID-F29DFC19-4E7F-47A6-98DB-9FE4AB6E29EC"></a></span>The static up vector moves with the chain. Global static up vectors aren't always
                                 useful because the up vector doesn't move with the chain (such as when a character
                                 walks). This is a good alternative to using an up-vector control object when you know
                                 the up vector won't change relative to the root. And without an extra up-vector control
                                 object, you can have a simpler character rig setup. 
                              </p> 
                           </li>
                           <li> 
                              <p><span class="anchor_wrapper"><a name="GUID-45DF3EFD-6C1E-4998-B5FA-2752642A3EDA"></a></span>You can override the default resolution plane behavior. When the <span class="MenuCascade" id="GUID-C8A2B919-3F03-4CE8-91F5-C4547F66404C">Res. Plane</span> is set to <span class="MenuCascade" id="GUID-FA07053A-6AF5-4898-86FE-32F370FE3A42">Default</span>, Softimage uses the chain root's Z axis as the preferred axis. Selecting <span class="MenuCascade" id="GUID-7D676DF8-2E80-46BC-B9A8-932B451736C7">Use Root Coordinates</span> with a static up vector is the same as overriding this default behavior, such as
                                 when you want the chain root to have zero rotation. 
                              </p> 
                           </li>
                        </ul> 
                     </li>
                  </ol> 
               </div> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-005B"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-0194C8D8-6662-4B47-9949-A6719ADBBE2B"></a></span>Setting the Roll to Correct the Orientation
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-97161017-EF55-4C6A-A0F5-E2736E0ABEFF"></a></span>Getting the up-vector constraint to work as expected depends on which side of the
                  root you draw the chain: the Y axis of the first bone will be pointing either inward
                  or outward. 
               </p> <span class="anchor_wrapper"><a name="FIG_06D4990FCEED4EFA95592B942AED1EDB"></a></span><div class="figure-anchor"><img src="../images/GUID-05AFC91C-AEA4-41E9-862A-AC07FD5E1BEE-low.png"></div> 
               <p><span class="anchor_wrapper"><a name="GUID-8D6B97C5-BF79-4D72-A3F3-4BB9518B8AAD"></a></span>If you set an up vector on the chain on the right, it works perfectly. However, if
                  you do this for the left chain (with the left sphere), it flips because the up vector
                  makes the first bone's Y axis point toward the sphere. To correct this, you can set
                  the joint's Roll to 180 (see <span class="char_link"><a href="ik_RollinganIKBone.htm">Rolling an IK Bone</a></span> for more information). 
               </p> 
               <p><span class="anchor_wrapper"><a name="GUID-0BF903FE-0A13-4A25-ABA2-370F9995DB8B"></a></span>Because the chain's up vector isn't a real constraint, this means that you can't use
                  offsets as you do when compensating typical constraints. To compensate on the position
                  of an up-vector constraining object (such as if it's in front of an arm or leg instead
                  of behind it), set the Roll on the bone where the up vector is applied. 
               </p> 
            </div>
            <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-005D"></a></span> 
               <h2><span class="anchor_wrapper"><a name="GUID-FBB6E340-77FC-4CD8-9B4B-301173DD0354"></a></span>Removing Up Vector Constraints
               </h2> 
               <p><span class="anchor_wrapper"><a name="GUID-7E44CF57-A580-49E7-A516-6F9DF7F179B2"></a></span>When you choose the <span class="MenuCascade" id="GUID-83FE7C74-4DBD-480D-8E52-0DD73A38E15B">Chain Up Vector</span> command (see <span class="char_link"><a href="ik_ConstrainingtheChainxd5sUpVectorDirection.htm#WSF4D645293765AE498C69174E3D6620E4-0056">Constraining the Up Vector to an Object</a></span>), a skeleton up-vector operator is created. To remove the up-vector constraint, you
                  must delete both the operator and reset the resolution plane. 
               </p> 
               <div class="section"><span class="anchor_wrapper"><a name="WSF4D645293765AE498C69174E3D6620E4-005E"></a></span> 
                  <h3><span class="anchor_wrapper"><a name="GUID-FA69FF7B-A6A2-46B9-8E3E-01F51BF50A08"></a></span>To remove the up-vector constraint
                  </h3> <span class="anchor_wrapper"><a name="GUID-E271D3DB-2E30-4275-AFE5-2A88BF73437E"></a></span><ol type="1" start="1">
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-8216771C-B1A9-400F-83F1-C1F468D52333"></a></span>In the explorer, delete the <span class="MenuCascade" id="GUID-CBD6116F-9D43-4FE0-B057-6E5FCF64A3B5">SkeletonUpVectorOp</span> operator under the bone's Kinematic Joint property. This disconnects the constraining
                           object from the up vector. 
                        </p> 
                     </li>
                     <li> 
                        <p><span class="anchor_wrapper"><a name="GUID-978DE643-B79B-4231-8111-80E01D85A35E"></a></span>On the Kinematic Joint &gt; Resolution Plan property page, set the <span class="MenuCascade" id="GUID-C0C6939C-F460-4FC7-96D2-DD575416753A">Res. Plane</span> back to Default. 
                        </p> 
                        <div><span class="anchor_wrapper"><a name="GUID-C00E4319-893F-48BE-A4B8-B634CDE8C621"></a></span><div class="note-note"><span class="label">NOTE:</span> <span class="anchor_wrapper"><a name="UL_AC88E18CF97D46A79FF2A05813694814"></a></span><ul>
                                 <li>When you created the up-vector constraint, the <span class="MenuCascade" id="GUID-C1AA09A6-3212-44D4-9AA3-30709AFA5806">Chain/Subchain Behavior</span> on the Kinematic Joint &gt; General page was set to 3D. However, if you change the Resolution
                                    Plane back to default, the subchain behavior does not change: you must reset it if
                                    you want to return to the previous IK behavior. 
                                 </li>
                              </ul> 
                           </div>
                        </div> 
                        <p><span class="anchor_wrapper"><a name="GUID-CA7E9A9E-11B1-4267-8C14-B60E5AF04B57"></a></span>For information on subchains, see <span class="char_link"><a href="ik_CreatingSubchainsforIndependentMovement.htm#WSF4D645293765AE498C69174E3D6620E4-0084"> Creating Subchains for Independent Movement</a></span>. 
                        </p> 
                     </li>
                  </ol> 
               </div> 
            </div>
         </div>
         <div class="footer-block"><a href="../html/ac.cmtdialog.htm" class="comments-anchor" target="_blank"><span class="comments-link">Please send us your comment about this page</span></a></div><br><p class="footer-license-block"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank"><img alt="Creative Commons License" style="border-width: 0;" src="../images/ccLink.png"></a>&nbsp;<em>Except where otherwise noted, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. Please see the <a href="http://autodesk.com/creativecommons" target="_blank">Autodesk Creative Commons FAQ</a> for more information.</em></p><br></div>
   </body>
</html>